<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Painel Administrativo - Quality Celulares</title>
  <link rel="stylesheet" href="css/style.css">
  <style>
    body { font-family: Arial, sans-serif; margin: 0; background: #f5f5f5; display: flex; }
    h1 { color: #c90000; margin-bottom: 20px; }
    .container { flex: 1; padding: 20px; overflow-y: auto; }
    .section { margin-bottom: 15px; background: #fff; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    .section-header { padding: 15px; cursor: pointer; background: #eee; border-radius: 10px 10px 0 0; }
    .section-header:hover { background: #ddd; }
    .section-header h2 { margin: 0; font-size: 18px; }
    .section-content { display: none; padding: 20px; }
    label { display: block; margin-top: 10px; font-weight: bold; }
    small { display: block; color: #666; margin-top: 2px; margin-bottom: 8px; }
    input, textarea, select { width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #ccc; border-radius: 5px; }
    button { margin-top: 10px; padding: 8px 12px; background: #c90000; color: white; border: none; cursor: pointer; border-radius: 5px; }
    button:hover { background: #a00000; }
    .item { padding: 10px; border-bottom: 1px solid #eee; margin-bottom: 10px; }
    .preview { border: 1px solid #ccc; padding: 10px; margin-top: 10px; border-radius: 6px; }
    img.preview-img { max-width: 200px; display: block; margin: 5px 0; border-radius: 6px; }
    /* sidebar */
    .sidebar { width: 220px; background: #222; color: #fff; height: 100vh; padding: 20px; box-sizing: border-box; position: sticky; top: 0; }
    .sidebar h2 { font-size: 18px; margin-bottom: 15px; color: #c90000; }
    .sidebar a { display: block; padding: 10px; margin: 5px 0; color: #fff; text-decoration: none; border-radius: 5px; transition: background .2s; }
    .sidebar a:hover, .sidebar a.active { background: #c90000; }
  </style>
</head>
<body>
  <div class="sidebar">
    <h2>Admin</h2>
    <a href="#estilo">🎨 Estilo</a>
    <a href="#menu">📑 Menu</a>
    <a href="#categorias">📂 Categorias</a>
    <a href="#banners">🖼️ Banners</a>
    <a href="#produtos">📦 Produtos</a>
    <a href="#footer">⬇️ Footer</a>
    <a href="#paginas">📄 Páginas</a>
  </div>

  <div class="container">
    <h1>⚙️ Painel Administrativo</h1>

    <!-- ===============================
         ESTILO
    ================================ -->
    <div class="section" id="estilo">
      <div class="section-header" onclick="toggleSection(this)">
        <h2>🎨 Estilo do Site</h2>
      </div>
      <div class="section-content">
        <label>Cor do Header</label>
        <input type="color" id="cor-header">
        <label>Cor dos Botões</label>
        <input type="color" id="cor-botoes">
        <label>Cor do Rodapé</label>
        <input type="color" id="cor-footer">
        <label>Cor do Texto</label>
        <input type="color" id="cor-texto">
        <label>Fonte (Google Fonts)</label>
        <select id="fonte-site">
          <option value="Arial">Arial</option>
          <option value="Roboto">Roboto</option>
          <option value="Poppins">Poppins</option>
          <option value="Open Sans">Open Sans</option>
        </select>
        <label>Tamanho da fonte</label>
        <select id="tamanho-fonte">
          <option value="14px">Pequeno</option>
          <option value="16px" selected>Médio</option>
          <option value="18px">Grande</option>
          <option value="20px">Muito grande</option>
        </select>
        <button onclick="listarEstilo()">📋 Listar</button>
        <button onclick="salvarEstilo()">💾 Salvar</button>
        <div id="preview-estilo" class="preview"></div>
      </div>
    </div>

    <!-- ===============================
         MENU
    ================================ -->
    <div class="section" id="menu">
      <div class="section-header" onclick="toggleSection(this)">
        <h2>📑 Menu do Header</h2>
      </div>
      <div class="section-content">
        <button onclick="listarMenu()">📋 Listar</button>
        <button onclick="novoMenu()">➕ Novo Link</button>
        <button onclick="salvarMenu()">💾 Salvar</button>
        <div id="lista-menu"></div>
      </div>
    </div>

    <!-- ===============================
         CATEGORIAS
    ================================ -->
    <div class="section" id="categorias">
      <div class="section-header" onclick="toggleSection(this)">
        <h2>📂 Categorias</h2>
      </div>
      <div class="section-content">
        <button onclick="listarCategorias()">📋 Listar</button>
        <button onclick="novaCategoria()">➕ Nova</button>
        <button onclick="salvarCategorias()">💾 Salvar</button>
        <div id="lista-categorias"></div>
      </div>
    </div>

    <!-- ===============================
         BANNERS
    ================================ -->
    <div class="section" id="banners">
      <div class="section-header" onclick="toggleSection(this)">
        <h2>🖼️ Banners</h2>
      </div>
      <div class="section-content">
        <button onclick="listarBanners()">📋 Listar</button>
        <button onclick="novoBanner()">➕ Novo</button>
        <button onclick="salvarBanners()">💾 Salvar</button>
        <div id="lista-banners"></div>
      </div>
    </div>

    <!-- ===============================
         PRODUTOS
    ================================ -->
    <div class="section" id="produtos">
      <div class="section-header" onclick="toggleSection(this)">
        <h2>📦 Produtos</h2>
      </div>
      <div class="section-content">
        <p>Gerencie seus produtos em uma página dedicada.</p>
        <a href="admin-produtos.html"><button>👉 Ir para Gerenciar Produtos</button></a>
      </div>
    </div>

    <!-- ===============================
         FOOTER
    ================================ -->
    <div class="section" id="footer">
      <div class="section-header" onclick="toggleSection(this)">
        <h2>⬇️ Footer</h2>
      </div>
      <div class="section-content">
        <button onclick="carregarFooter()">📋 Listar</button>
        <div id="footer-editor"></div>
        <h3>🔗 Links Extras</h3>
        <button onclick="novoFooterLink()">➕ Novo</button>
        <div id="footer-links-list"></div>
        <h3>🌐 Ícones Sociais</h3>
        <button onclick="novoSocial()">➕ Novo</button>
        <div id="footer-sociais-list"></div>
      </div>
    </div>

    <!-- ===============================
         PÁGINAS ESTÁTICAS
    ================================ -->
    <div class="section" id="paginas">
      <div class="section-header" onclick="toggleSection(this)">
        <h2>📄 Páginas Estáticas</h2>
      </div>
      <div class="section-content">
        <button onclick="listarPaginas()">📋 Listar</button>
        <div id="lista-paginas"></div>
        <div id="pagina-editor"></div>
      </div>
    </div>
  </div>

  <script>
    const API = "http://localhost:3000/api";

    function toggleSection(header) {
      const content = header.nextElementSibling;
      content.style.display = content.style.display === "block" ? "none" : "block";
    }

    // ========= ESTILO =========
    async function listarEstilo() {
      const res = await fetch(`${API}/settings`);
      const s = await res.json();
      document.getElementById("cor-header").value = s.cores?.header || "#c90000";
      document.getElementById("cor-botoes").value = s.cores?.botoes || "#c90000";
      document.getElementById("cor-footer").value = s.cores?.footer || "#111111";
      document.getElementById("cor-texto").value = s.cores?.texto || "#000000";
      document.getElementById("fonte-site").value = s.fonte || "Arial";
      document.getElementById("tamanho-fonte").value = s.tamanhoFonte || "16px";
      document.getElementById("preview-estilo").innerHTML =
        `<div style="background:${s.cores?.header};color:#fff;padding:10px;">Header</div>
         <button style="background:${s.cores?.botoes};color:#fff;padding:5px 10px;border:none;border-radius:5px;">Botão</button>
         <p style="color:${s.cores?.texto};font-family:${s.fonte};font-size:${s.tamanhoFonte};">Texto exemplo</p>
         <div style="background:${s.cores?.footer};color:#fff;padding:10px;">Rodapé</div>`;
    }
    async function salvarEstilo() {
      const res = await fetch(`${API}/settings`);
      const settings = await res.json();
      settings.cores = {
        header: document.getElementById("cor-header").value,
        botoes: document.getElementById("cor-botoes").value,
        footer: document.getElementById("cor-footer").value,
        texto: document.getElementById("cor-texto").value
      };
      settings.fonte = document.getElementById("fonte-site").value;
      settings.tamanhoFonte = document.getElementById("tamanho-fonte").value;
      await fetch(`${API}/settings`, {
        method: "PUT", headers: { "Content-Type": "application/json" },
        body: JSON.stringify(settings)
      });
      alert("Estilo salvo!");
    }

    // ========= MENU =========
    let menuTemp = [];
    async function listarMenu() {
      const res = await fetch(`${API}/menu`);
      menuTemp = await res.json();
      renderMenu();
    }
    function renderMenu() {
      const c = document.getElementById("lista-menu");
      c.innerHTML = "";
      if (!menuTemp.length) return c.innerHTML = "<p>Nenhum item de menu.</p>";
      menuTemp.forEach((m, i) => {
        c.innerHTML += `<div class="item">
          <label>Texto</label><input type="text" value="${m.texto}" onchange="updateMenu(${i},'texto',this.value)">
          <label>Link</label><input type="text" value="${m.link}" onchange="updateMenu(${i},'link',this.value)">
          <button onclick="removerMenu(${i})">🗑️</button>
        </div>`;
      });
    }
    function novoMenu(){ menuTemp.push({texto:"Novo",link:"#"}); renderMenu();}
    function updateMenu(i,f,v){ menuTemp[i][f]=v;}
    function removerMenu(i){ menuTemp.splice(i,1); renderMenu();}
    async function salvarMenu(){
      await fetch(`${API}/menu`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(menuTemp)});
      alert("Menu salvo!"); listarMenu();
    }

    // ========= CATEGORIAS =========
    let categoriasTemp=[];
    async function listarCategorias(){
      const res=await fetch(`${API}/categories`);
      categoriasTemp=await res.json(); renderCategorias();
    }
    function renderCategorias(){
      const c=document.getElementById("lista-categorias");
      c.innerHTML="";
      if(!categoriasTemp.length) return c.innerHTML="<p>Nenhuma categoria.</p>";
      categoriasTemp.forEach((cat,i)=>{
        c.innerHTML+=`<div class="item">
          <label>Nome</label><input type="text" value="${cat.nome}" onchange="updateCategoria(${i},'nome',this.value)">
          <label>Slug</label><input type="text" value="${cat.slug}" onchange="updateCategoria(${i},'slug',this.value)">
          <button onclick="removerCategoria(${i})">🗑️</button>
        </div>`;
      });
    }
    function novaCategoria(){categoriasTemp.push({nome:"Nova",slug:"nova"}); renderCategorias();}
    function updateCategoria(i,f,v){categoriasTemp[i][f]=v;}
    function removerCategoria(i){categoriasTemp.splice(i,1); renderCategorias();}
    async function salvarCategorias(){
      await fetch(`${API}/categories`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(categoriasTemp)});
      alert("Categorias salvas!"); listarCategorias();
    }

    // ========= BANNERS =========
    let bannersTemp=[];
    async function listarBanners(){
      const res=await fetch(`${API}/banners`);
      bannersTemp=await res.json(); renderBanners();
    }
    function renderBanners(){
      const c=document.getElementById("lista-banners");
      c.innerHTML="";
      if(!bannersTemp.length) return c.innerHTML="<p>Nenhum banner.</p>";
      bannersTemp.forEach((b,i)=>{
        c.innerHTML+=`<div class="item">
          <label>Desktop</label><input type="text" value="${b.desktop}" onchange="updateBanner(${i},'desktop',this.value)">
          <img src="${b.desktop}" class="preview-img">
          <label>Mobile</label><input type="text" value="${b.mobile}" onchange="updateBanner(${i},'mobile',this.value)">
          <img src="${b.mobile}" class="preview-img">
          <button onclick="removerBanner(${i})">🗑️</button>
        </div>`;
      });
    }
    function novoBanner(){bannersTemp.push({desktop:"",mobile:""}); renderBanners();}
    function updateBanner(i,f,v){bannersTemp[i][f]=v;}
    function removerBanner(i){bannersTemp.splice(i,1); renderBanners();}
    async function salvarBanners(){
      await fetch(`${API}/banners`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(bannersTemp)});
      alert("Banners salvos!"); listarBanners();
    }

    // ========= PÁGINAS =========
    let paginasTemp={};
    async function listarPaginas(){
      const res=await fetch(`${API}/settings`);
      const s=await res.json(); paginasTemp=s.paginas||{}; renderPaginas();
    }
    function renderPaginas(){
      const c=document.getElementById("lista-paginas"); c.innerHTML="";
      Object.entries(paginasTemp).forEach(([k,p])=>{
        c.innerHTML+=`<div class="item"><strong>${p.titulo}</strong> <button onclick="editarPagina('${k}')">✏️</button></div>`;
      });
    }
    function editarPagina(k){
      const p=paginasTemp[k];
      document.getElementById("pagina-editor").innerHTML=
        `<h3>Editando: ${p.titulo}</h3>
        <textarea id="conteudo-pagina" rows="10">${p.conteudo}</textarea>
        <button onclick="salvarPagina('${k}')">Salvar</button>`;
    }
    async function salvarPagina(k){
      paginasTemp[k].conteudo=document.getElementById("conteudo-pagina").value;
      const res=await fetch(`${API}/settings`); const s=await res.json(); s.paginas=paginasTemp;
      await fetch(`${API}/settings`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});
      alert("Página salva!");
    }

    // ========= FOOTER =========
    let footerLinksTemp=[]; let footerSociaisTemp={};
    async function carregarFooter(){
      const res=await fetch(`${API}/settings`);
      const s=await res.json();
      document.getElementById("footer-editor").innerHTML=
        `<label>Texto</label><input type="text" id="footer-texto" value="${s.footer.texto||""}">
         <label>CNPJ</label><input type="text" id="footer-cnpj" value="${s.footer.cnpj||""}">
         <button onclick="salvarFooter()">Salvar</button>`;
      footerLinksTemp=s.footer.links||[]; footerSociaisTemp=s.footer.icones||{};
      renderFooterLinks(); renderFooterSociais();
    }
    function renderFooterLinks(){
      const c=document.getElementById("footer-links-list"); c.innerHTML="";
      if(!footerLinksTemp.length) return c.innerHTML="<p>Nenhum link.</p>";
      footerLinksTemp.forEach((l,i)=>{
        c.innerHTML+=`<div class="item"><label>Texto</label><input type="text" value="${l.texto}" onchange="updateFooterLink(${i},'texto',this.value)">
        <label>URL</label><input type="text" value="${l.link}" onchange="updateFooterLink(${i},'link',this.value)">
        <button onclick="removerFooterLink(${i})">🗑️</button></div>`;
      });
    }
    function novoFooterLink(){footerLinksTemp.push({texto:"Novo link",link:"#"}); renderFooterLinks();}
    function updateFooterLink(i,f,v){footerLinksTemp[i][f]=v;}
    function removerFooterLink(i){footerLinksTemp.splice(i,1); renderFooterLinks();}
    function renderFooterSociais(){
      const c=document.getElementById("footer-sociais-list"); c.innerHTML="";
      if(!Object.keys(footerSociaisTemp).length) return c.innerHTML="<p>Nenhum ícone social.</p>";
      Object.entries(footerSociaisTemp).forEach(([n,u])=>{
        c.innerHTML+=`<div class="item"><label>${n}</label>
        <input type="text" value="${u}" onchange="updateSocial('${n}',this.value)">
        <button onclick="removerSocial('${n}')">🗑️</button></div>`;
      });
    }
    function novoSocial(){const n=prompt("Nome do ícone (facebook, instagram...)"); if(n&&!footerSociaisTemp[n]){footerSociaisTemp[n]="#"; renderFooterSociais();}}
    function updateSocial(n,u){footerSociaisTemp[n]=u;}
    function removerSocial(n){delete footerSociaisTemp[n]; renderFooterSociais();}
    async function salvarFooter(){
      const res=await fetch(`${API}/settings`); const s=await res.json();
      s.footer={texto:document.getElementById("footer-texto").value,cnpj:document.getElementById("footer-cnpj").value,links:footerLinksTemp,icones:footerSociaisTemp};
      await fetch(`${API}/settings`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});
      alert("Footer salvo!"); carregarFooter();
    }
  </script>
</body>
</html>
